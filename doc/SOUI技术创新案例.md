# 技术创新案例:SOUI

## 背景概述

SOUI 是一套已经持续开发维护 14 年的轻量级原生桌面客户端开发框架,内核编译后体积约 2MB(+7MB的跨平台库体积)。框架设计吸收了 WTL、Android、QT、Flash 等流行框架的特点,UI 展示基于 XML 配置,性能高效(可选择 GDI、Skia、D2D 渲染),控件丰富,扩展灵活(可使用 xml + lua + js),真正做到 UI 界面与逻辑分离。

SOUI 的核心创新在于其独特的跨平台解决方案——SwinX 兼容层。SwinX 是一个类似 Wine 的帮助 Windows 平台程序运行到 Linux、macOS 平台上的胶水库,通过在 Linux 和 macOS 平台实现 Windows 客户端必须的 API,让 现有Windows 客户端代码链接 SwinX 后即可像在 Windows 平台一样在 Linux 及 macOS 平台运行。目前 SOUI 所有功能都已经通过 SwinX 实现跨平台。

## 功能介绍

SOUI 框架的主要功能包括:

● **跨平台支持**: 通过 SwinX 兼容层实现 Windows API 在 Linux 和 macOS 平台上的兼容运行,支持 Windows、Linux、macOS 三大桌面平台,包括OpenKylin等国产 Linux 操作系统。

● **统一的编程接口**: 在所有平台上都使用相同的 Windows API 头文件和编程模式,无需为不同平台修改代码,同一套 C++ 代码可在三大桌面平台编译运行。

● **XML 驱动的 UI 界面**: 通过 XML 定义 UI 界面,实现 UI 与逻辑的分离,类似 Android 的开发模式。

● **丰富的控件库**: 提供完整的控件体系,包括按钮、列表、树、富文本、动画图片、动画器、扩展按钮、聊天编辑框、十六进制编辑器、标签页、工具栏、树形列表等。

● **高性能渲染**: 支持 GDI、Skia、D2D 三种渲染引擎,可根据需求选择合适的渲染方案, Swinx基于开源2d图形库Cairo实现了所有windows平台提供的GDI接口, 在linux平台下,使用GDI渲染时,底层基于高性能图形库Cairo实现。

● **强大的动画系统**: 支持属性动画、帧动画(APNG)和窗口动画,各种动画效果都可以通过XML配置实现,通过内置的动画时间轴系统统一驱动,保证动画的高效运行。

● **图像解码**: 支持 STB、GDI+、WIC 等多种图像解码方式。

● **网络通信**: 内置 HTTP , WebSocket, Network 网络通信支持。

● **多语言绑定**: 不仅支持 C++ 开发,还提供了 SOUI4JS(JavaScript 版本)和 SOUI4PY(Python3 版本)。

● **类 COM 对象管理**: 整体设计使用类 COM 方式,通过引用计数自动管理对象生命周期,大大减少内存泄漏风险。

● **模块化组件架构**: 提供灵活的组件配置,可根据需要选择不同的图像解码器、渲染引擎、脚本模块等。

● **可视化 UI 设计器**: 集成 souieditor 可视化 UI 设计器,提高开发效率。

● **资源管理**: 支持 ZIP 和 7z 压缩包资源加载。

● **国际化支持**: 内置翻译器组件,支持多语言国际化。

● **高分屏适配**: 实现了创新的缩放机制,支持不同DPI屏幕的完美适配,包括：
  - **自由拉伸支持**: 窗口可自由调整大小,元素自动适配布局
  - **DPI感知**: 自动感知系统DPI设置,确保在高分屏上显示清晰
  - **跨平台一致**: 在Windows、Linux、macOS平台上保持相同的高分屏体验

## 应用场景

SOUI 框架适用于各种需要进行跨平台桌面应用开发的场景,特别适合以下情况:

● **现有 Windows 项目迁移**: 对于已经在 Windows 平台运行的桌面应用程序,通过 SOUI 和 SwinX 兼容层,可以最小化代码修改的情况下,将应用迁移到 Linux 和 macOS 平台。

● **国产系统适配**: 在国家推动信息技术应用创新的背景下,SOUI 为 Windows 平台项目提供了快速适配包括OpenKylin等等国产 Linux 操作系统的技术路径,无需重写整个应用代码。

● **跨平台企业应用**: 需要在 Windows、Linux、macOS 多个平台上运行的企业级桌面应用,如办公软件、管理工具、客户端应用等。

● **高性能桌面应用**: 对性能要求较高的桌面应用,如游戏客户端、图形编辑器、数据分析工具等,SOUI 的高性能渲染和轻量级设计能够满足需求。

● **UI 与逻辑分离的应用**: 需要频繁修改 UI 界面的应用,通过 XML 配置可以快速调整界面,无需重新编译代码。

● **需要动画效果的应用**: 对 UI 交互体验要求较高的应用,SOUI 强大的动画系统可以实现流畅、生动的用户界面, SOUI 框架在其内置的三个棋牌游戏（中国象棋、军旗、升级）中实现了业界领先的动画效果，全面超越市场上同类项目。

● **多语言开发团队**: 团队成员熟悉不同的编程语言(C++/JavaScript/Python),SOUI 提供了多语言绑定,可以发挥团队成员的技术优势。

● **需要快速迭代的原型开发**: 通过 XML 配置和脚本扩展,可以快速实现原型并进行迭代。

## 项目地址

- SOUI: https://gitee.com/openkylin/soui
- SwinX: https://gitcode.com/openkylin/swinx
- SOUI4JS: (JavaScript 脚本扩展): https://gitee.com/setoutsoft/soui4js
- SOUI4PY: (Python3 脚本扩展): https://gitee.com/setoutsoft/soui4py
